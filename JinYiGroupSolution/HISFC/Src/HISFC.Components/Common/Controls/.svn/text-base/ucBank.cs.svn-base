using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Text;
using System.Windows.Forms;

namespace Neusoft.HISFC.Components.Common.Controls
{
    
    public partial class ucBank : Neusoft.FrameWork.WinForms.Controls.ucBaseControl
    {
        private System.Windows.Forms.Label lblBank;
        private Neusoft.FrameWork.WinForms.Controls.NeuComboBox cmbBank;
        private System.Windows.Forms.TextBox txtBankCardNo;
        private System.Windows.Forms.TextBox txtPosNo;
        private System.Windows.Forms.Label lblBankCardNo;
        private System.Windows.Forms.Label lblPosNo;
        private System.Windows.Forms.Button btnOK;
        private System.Windows.Forms.Button btnExit;
        private System.Windows.Forms.Label lblWorkName;
        private System.Windows.Forms.TextBox txtWorkName;
        private System.ComponentModel.IContainer components;

        public ucBank()
        {
            // 该调用是 Windows.Forms 窗体设计器所必需的。
            InitializeComponent();

            // TODO: 在 InitializeComponent 调用后添加任何初始化
            
        }

        /// <summary> 
        /// 清理所有正在使用的资源。


        /// </summary>
        protected override void Dispose(bool disposing)
        {
            if (disposing)
            {
                if (components != null)
                {
                    components.Dispose();
                }
            }
            base.Dispose(disposing);
        }

        #region 组件设计器生成的代码
        /// <summary> 
        /// 设计器支持所需的方法 - 不要使用代码编辑器 
        /// 修改此方法的内容。


        /// </summary>
        private void InitializeComponent()
        {
            this.components = new System.ComponentModel.Container();
            this.lblBank = new System.Windows.Forms.Label();
            this.cmbBank = new Neusoft.FrameWork.WinForms.Controls.NeuComboBox(this.components);
            this.txtBankCardNo = new System.Windows.Forms.TextBox();
            this.txtPosNo = new System.Windows.Forms.TextBox();
            this.lblBankCardNo = new System.Windows.Forms.Label();
            this.lblPosNo = new System.Windows.Forms.Label();
            this.btnOK = new System.Windows.Forms.Button();
            this.btnExit = new System.Windows.Forms.Button();
            this.lblWorkName = new System.Windows.Forms.Label();
            this.txtWorkName = new System.Windows.Forms.TextBox();
            this.SuspendLayout();
            // 
            // lblBank
            // 
            this.lblBank.Location = new System.Drawing.Point(11, 56);
            this.lblBank.Name = "lblBank";
            this.lblBank.Size = new System.Drawing.Size(64, 16);
            this.lblBank.TabIndex = 1;
            this.lblBank.Text = "银行：";
            // 
            // cmbBank
            // 
            this.cmbBank.ArrowBackColor = System.Drawing.Color.Silver;
            this.cmbBank.DrawMode = System.Windows.Forms.DrawMode.OwnerDrawFixed;
            this.cmbBank.IsLike = true;
            this.cmbBank.Location = new System.Drawing.Point(67, 48);
            this.cmbBank.Name = "cmbBank";
            this.cmbBank.PopForm = null;
            //this.cmbBank.ShowCustomerList = true;
            this.cmbBank.ShowID = false;
            this.cmbBank.Size = new System.Drawing.Size(176, 22);
            this.cmbBank.TabIndex = 1;
            this.cmbBank.Tag = "";
            // 
            // txtBankCardNo
            // 
            this.txtBankCardNo.Location = new System.Drawing.Point(67, 88);
            this.txtBankCardNo.MaxLength = 25;
            this.txtBankCardNo.Name = "textBox1";
            this.txtBankCardNo.Size = new System.Drawing.Size(176, 21);
            this.txtBankCardNo.TabIndex = 2;
            this.txtBankCardNo.Text = "";
            // 
            // txtPosNo
            // 
            this.txtPosNo.Location = new System.Drawing.Point(67, 128);
            this.txtPosNo.MaxLength = 15;
            this.txtPosNo.Name = "textBox2";
            this.txtPosNo.Size = new System.Drawing.Size(176, 21);
            this.txtPosNo.TabIndex = 3;
            this.txtPosNo.Text = "";
            // 
            // lblBankCardNo
            // 
            this.lblBankCardNo.Location = new System.Drawing.Point(11, 96);
            this.lblBankCardNo.Name = "label2";
            this.lblBankCardNo.Size = new System.Drawing.Size(48, 24);
            this.lblBankCardNo.TabIndex = 5;
            this.lblBankCardNo.Text = "帐号：";
            // 
            // lblPosNo
            // 
            this.lblPosNo.Location = new System.Drawing.Point(11, 136);
            this.lblPosNo.Name = "label3";
            this.lblPosNo.Size = new System.Drawing.Size(56, 24);
            this.lblPosNo.TabIndex = 6;
            this.lblPosNo.Text = "小票号：";
            // 
            // button1
            // 
            this.btnOK.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.btnOK.Location = new System.Drawing.Point(75, 168);
            this.btnOK.Name = "btnOK";
            this.btnOK.Size = new System.Drawing.Size(88, 24);
            this.btnOK.TabIndex = 7;
            this.btnOK.Text = "确定";
            this.btnOK.Click += new System.EventHandler(this.btnOK_Click);
            // 
            // button2
            // 
            this.btnExit.FlatStyle = System.Windows.Forms.FlatStyle.Popup;
            this.btnExit.Location = new System.Drawing.Point(163, 168);
            this.btnExit.Name = "btnExit";
            this.btnExit.Size = new System.Drawing.Size(88, 24);
            this.btnExit.TabIndex = 8;
            this.btnExit.Text = "取消";
            this.btnExit.Click += new System.EventHandler(this.btnExit_Click);
            // 
            // lblWorkName
            // 
            this.lblWorkName.Location = new System.Drawing.Point(3, 22);
            this.lblWorkName.Name = "label4";
            this.lblWorkName.Size = new System.Drawing.Size(72, 16);
            this.lblWorkName.TabIndex = 10;
            this.lblWorkName.Text = "开户单位：";
            // 
            // txtWorkName
            // 
            this.txtWorkName.Location = new System.Drawing.Point(67, 16);
            this.txtWorkName.MaxLength = 25;
            this.txtWorkName.Name = "txtWorkName";
            this.txtWorkName.Size = new System.Drawing.Size(176, 21);
            this.txtWorkName.TabIndex = 0;
            this.txtWorkName.Text = "";
            // 
            // ucBank
            // 
            this.Controls.Add(this.txtWorkName);
            this.Controls.Add(this.lblWorkName);
            this.Controls.Add(this.btnExit);
            this.Controls.Add(this.btnOK);
            this.Controls.Add(this.lblPosNo);
            this.Controls.Add(this.lblBankCardNo);
            this.Controls.Add(this.txtPosNo);
            this.Controls.Add(this.txtBankCardNo);
            this.Controls.Add(this.cmbBank);
            this.Controls.Add(this.lblBank);
            this.Name = "ucBank";
            this.Size = new System.Drawing.Size(264, 208);
            this.Load += new System.EventHandler(this.ucBank_Load);
            this.KeyDown += new System.Windows.Forms.KeyEventHandler(this.ucBank_KeyDown);
            this.ResumeLayout(false);

        }
        #endregion

        #region "变量"

        /// <summary>
        ///银行实体变量 
        /// </summary>
        public Neusoft.HISFC.Models.Base.Bank Bank = new Neusoft.HISFC.Models.Base.Bank();

        #endregion

        #region "业务层变量"

        /// <summary>
        /// 业务层管理常数类变量
        /// </summary>
        private Neusoft.HISFC.BizProcess.Integrate.Manager managerIntegrate = new Neusoft.HISFC.BizProcess.Integrate.Manager();

        #endregion

        #region "事件"

        /// <summary>
        /// ucBank窗口load事件
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void ucBank_Load(object sender, System.EventArgs e)
        {
            try
            {
                foreach (Control con in this.Controls)
                {
                    con.KeyDown += new KeyEventHandler(con_KeyDown);
                }
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
                return;
            }
            try
            {
                //添加银行列表
                this.cmbBank.AddItems(managerIntegrate.GetConstantList(Neusoft.HISFC.Models.Base.EnumConstant.BANK));
                //只能从列表中选择
                this.cmbBank.IsListOnly = true;

            }
            catch(Exception ex)
            {
                MessageBox.Show(ex.Message);
                return;
            }
            this.BackColor = this.Parent.BackColor;
        }

        /// <summary>
        /// 控件的回车事件 焦点自动跳转
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void con_KeyDown(object sender, KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Enter)
            {
                e.Handled = true;
                System.Windows.Forms.SendKeys.Send("{tab}");
                e.Handled = true;
            }
            if (e.KeyCode == Keys.Escape)
            {
                this.FindForm().Close();
            }
        }

        /// <summary>
        /// 控件键盘时间 esc关闭
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void ucBank_KeyDown(object sender, System.Windows.Forms.KeyEventArgs e)
        {
            if (e.KeyCode == System.Windows.Forms.Keys.Escape)
            {
                this.FindForm().Close();
            }
        }

        /// <summary>
        /// 确定事件
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void btnOK_Click(object sender, System.EventArgs e)
        {
            try
            {
                Bank.ID = this.cmbBank.Tag.ToString();
            }
            catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
                return;
            }
            Bank.Name = this.cmbBank.Text;
            Bank.Account = this.txtBankCardNo.Text;
            Bank.InvoiceNO = this.txtPosNo.Text;
            Bank.WorkName = this.txtWorkName.Text;
            this.btnExit_Click(sender, e);
        }

        /// <summary>
        /// 取消按钮时间 关闭窗口
        /// </summary>
        /// <param name="sender"></param>
        /// <param name="e"></param>
        private void btnExit_Click(object sender, System.EventArgs e)
        {
            this.FindForm().Close();
        }

        #endregion
        
    }
}

